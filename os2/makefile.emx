DEBUG   = 1
CC      = gcc

OBJS    = hpt.o pkt.o common.o log.o config.o global.o toss.o patmat.o
SRC_DIR = ..\src

!IF $(DEBUG) == 1
CFLAGS  = -c -I..\h -Wall -g -pedantic
LFLAGS  =
!ELSE
CFLAGS  = -O2 -c -I..\h -Wall -pedantic
LFLAGS  =
!ENDIF

all: $(OBJS) \
     pktinfo.exe \
     tlog.exe \
     tconfig.exe \
     hpt.exe

$(OBJS): $(SRC_DIR)\$*.c
  @echo compiling $*.c
  $(CC) $(CFLAGS) $(SRC_DIR)\$*.c

pktinfo.o tlog.o tconfig.o: $(SRC_DIR)\$*.c
  @echo compiling $*.c
  $(CC) $(CFLAGS) $(SRC_DIR)\$*.c

pktinfo.exe: pktinfo.o common.o pkt.o
  @echo linking pktinfo
  $(CC) $(LFLAGS) -o pktinfo.exe pktinfo.o common.o pkt.o

tlog.exe: tlog.o log.o
  @echo linking tlog
  $(CC) $(LFLAGS) -o tlog.exe tlog.o log.o

tconfig.exe: tconfig.o config.o common.o
  @echo linking tconfig
  $(CC) $(LFLAGS) -o tconfig.exe tconfig.o config.o common.o

hpt.exe: $(OBJS)
  @echo linking hpt
  $(CC) $(LFLAGS) -o hpt.exe $(OBJS)
