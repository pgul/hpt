DEBUG   = 0
CC      = wcc386
LINK    = WLINK

OBJS    = hpt.obj, pktread.obj, pktwrite.obj, fcommon.obj, log.obj, global.obj, toss.obj, scan.obj, scanarea.obj, seenby.obj, dupe.obj, tree.obj, recode.obj, areafix.obj, post.obj, link.obj, strsep.obj
SRC_DIR = ..\src

!IF $(DEBUG) == 1
CFLAGS  = -d2 -hw -i=..\h;..\..\smapi;..\..\fidoconfig -zq
LFLAGS  =
!ELSE
CFLAGS  = -i..\h;..\..\smapi;..\..\fidoconfig -oneatx -zq
LFLAGS  =
!ENDIF

all: $(OBJS) \
     pktinfo.exe \
     tlog.exe \
     purgedup.exe \
     hpt.exe

$(OBJS): $(SRC_DIR)\$*.c
  @echo compiling $*.c
  $(CC) $(CFLAGS) $(SRC_DIR)\$*.c

pktinfo.obj tlog.obj: $(SRC_DIR)\$*.c
  @echo compiling $*.c
  $(CC) $(CFLAGS) $(SRC_DIR)\$*.c

pktinfo.exe: pktinfo.obj fcommon.obj pktread.obj
  @echo linking pktinfo
  $(LINK) $(LFLAGS) FILE pktinfo.obj, pktread.obj, log.obj, global.obj LIBRARY ..\..\smapi\smapiwco, ..\..\fidoconfig\fidoconfig NAME pktinfo.exe

tlog.exe: tlog.obj log.obj
  @echo linking tlog
  $(LINK) $(LFLAGS) FILE tlog.obj, log.obj NAME tlog.exe

purgedup.exe: purgeDupes.obj global.obj dupe.obj tree.obj pktread.obj log.obj recode.obj
  @echo linking purgedup
  $(LINK) $(LFLAGS) FILE purgeDupes.obj, global.obj, dupe.obj, tree.obj, pktread.obj, log.obj, recode.obj LIBRARY ..\..\smapi\smapiwco, ..\..\fidoconfig\fidoconfig NAME purgedup.exe

hpt.exe: $(OBJS)
  @echo linking hpt
  $(LINK) $(LFLAGS) FILE $(OBJS) Library ..\..\smapi\smapiwco, ..\..\fidoconfig\fidoconfig.lib NAME hpt.exe
